# Practical 9: Run Length Compression

### Ascii Run Length Encoding

Code for encoding ascii strings can be found in
[ie.davidloftus.algorithms.compression.AsciiRunLength](../src/main/java/ie/davidloftus/algorithms/compression/AsciiRunLength.java)

Note that this encoding is only injective when the digits are not part of the input alphabet.
For example the string "1234" would be encoded to "11213141" which would make it ambigious how to decode it since we
 don't know where the run length ends, and the next letter starts.
Thus it is not possible to reverse this encoding on an ascii string, making it quite useless.

### Binary Run Length Encoding

Code for binary run length encoding can be found at
[ie.davidloftus.algorithms.compression.RunLength](../src/main/java/ie/davidloftus/algorithms/compression/RunLength.java)

Other helper tools can be found in the compression package. Do note these files, other than AsciiRunLength are not my
own but provided as part of the compression lab.


##### 4runs.bin

Here we have a binary file consisting of 4 continuous runs of bits. This can be efficiently compressed using run
 length encoding since there are long runs of bits.

```
$ java BinaryDump 40 < 4runs.bin
0000000000000001111111000000011111111111
40 bits
```

```
$ java RunLength - < 4runs.bin | java BinaryDump
0000111100000111
0000011100001011
32 bits
```

Compression ratio is 40/32 = 1.25

```
$ java RunLength - < 4runs.bin > 4runsrle.bin
$ java BinaryDump < 4runsrle.bin
0000111100000111
0000011100001011
32 bits
```

##### abra.txt

Here we have an ascii file with the word "ABRACADABRA" which totals **96 bits**

```
$ java BinaryDump < abra.txt                           
0100000101000010
0101001001000001
0100001101000001
0100010001000001
0100001001010010
0100000100100001
96 bits
```

```
$ java RunLength - < abra.txt | java BinaryDump
0000000100000001
0000010100000001
0000000100000001
0000010000000001
0000001000000001
0000000100000001
0000001000000001
0000001000000001
0000010100000001
0000000100000001
0000010000000010
0000000100000001
0000010100000001
0000000100000001
0000001100000001
0000001100000001
0000010100000001
0000000100000001
0000010000000001
0000001000000001
0000000100000001
0000001000000001
0000001000000001
0000010100000001
0000001000000001
0000010000000001
416 bits
```

So the compression ratio is 96/416 = **0.231**

This is so low because ascii letters don't have very long runs of bits,
there is a total of 52 runs in abra.txt which results in 416 bits (8 bits per run).
In order for Run Length Encoding to reduce the filesize, the average runs per character must be less than 1. This is
not possible using ASCII unless you have alot of null bytes.
 
Step 3 asks us to create a text file that can be compressed to a smaller size, but as explained above this is not
possible without using null bytes.

##### Bitmap Compression

We have two bitmap images q32x48.bin and a higher res version q64x96.bin
These images have long runs of bits, so they should be good for compression.

```
$ java BinaryDump 32 < q32x48.bin
00000000000000000000000000000000
00000000000000000000000000000000
00000000000000011111110000000000
00000000000011111111111111100000
00000000001111000011111111100000
00000000111100000000011111100000
00000001110000000000001111100000
00000011110000000000001111100000
00000111100000000000001111100000
00001111000000000000001111100000
00001111000000000000001111100000
00011110000000000000001111100000
00011110000000000000001111100000
00111110000000000000001111100000
00111110000000000000001111100000
00111110000000000000001111100000
00111110000000000000001111100000
00111110000000000000001111100000
00111110000000000000001111100000
00111110000000000000001111100000
00111110000000000000001111100000
00111111000000000000001111100000
00111111000000000000001111100000
00011111100000000000001111100000
00011111100000000000001111100000
00001111110000000000001111100000
00001111111000000000001111100000
00000111111100000000001111100000
00000011111111000000011111100000
00000001111111111111111111100000
00000000011111111111001111100000
00000000000011111000001111100000
00000000000000000000001111100000
00000000000000000000001111100000
00000000000000000000001111100000
00000000000000000000001111100000
00000000000000000000001111100000
00000000000000000000001111100000
00000000000000000000001111100000
00000000000000000000001111100000
00000000000000000000001111100000
00000000000000000000001111100000
00000000000000000000001111100000
00000000000000000000011111110000
00000000000000000011111111111100
00000000000000000111111111111110
00000000000000000000000000000000
00000000000000000000000000000000
1536 bits
$ java RunLength - < q32x48.bin > q32x48rle.bin
$ java BinaryDump 32 < q32x48rle.bin
01001111000001110001011000001111
00001111000001000000010000001001
00001101000001000000100100000110
00001100000000110000110000000101
00001011000001000000110000000101
00001010000001000000110100000101
00001001000001000000111000000101
00001001000001000000111000000101
00001000000001000000111100000101
00001000000001000000111100000101
00000111000001010000111100000101
00000111000001010000111100000101
00000111000001010000111100000101
00000111000001010000111100000101
00000111000001010000111100000101
00000111000001010000111100000101
00000111000001010000111100000101
00000111000001010000111100000101
00000111000001100000111000000101
00000111000001100000111000000101
00001000000001100000110100000101
00001000000001100000110100000101
00001001000001100000110000000101
00001001000001110000101100000101
00001010000001110000101000000101
00001011000010000000011100000110
00001100000101000000111000001011
00000010000001010001000100000101
00000101000001010001101100000101
00011011000001010001101100000101
00011011000001010001101100000101
00011011000001010001101100000101
00011011000001010001101100000101
00011011000001010001101100000101
00011010000001110001011000001100
000100110000111001000001
1144 bits
```

The compression ratio for q32x48.bin = **1536/1144 = 1.343**

```
$ java BinaryDump 64 < q64x96.bin
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000111111111110000000000000000000000
0000000000000000000000000011111111111111111111000000000000000000
0000000000000000000000011111111111111111111111111111111000000000
0000000000000000000001111111111111111111111111111111111000000000
0000000000000000000111111111111111111111111111111111111000000000
0000000000000000011111111111111111111111111111111111111000000000
0000000000000001111111111000000000000011111111111111111000000000
0000000000000011111111100000000000000000011111111111111000000000
0000000000000111111110000000000000000000001111111111111000000000
0000000000011111111100000000000000000000000011111111111000000000
0000000000111111111000000000000000000000000011111111111000000000
0000000001111111110000000000000000000000000011111111111000000000
0000000001111111100000000000000000000000000011111111110000000000
0000000011111111100000000000000000000000000011111111110000000000
0000000111111111000000000000000000000000000011111111110000000000
0000001111111110000000000000000000000000000011111111110000000000
0000001111111110000000000000000000000000000011111111110000000000
0000011111111110000000000000000000000000000011111111110000000000
0000111111111100000000000000000000000000000011111111110000000000
0000111111111100000000000000000000000000000011111111110000000000
0001111111111100000000000000000000000000000011111111110000000000
0001111111111000000000000000000000000000000011111111110000000000
0001111111111000000000000000000000000000000011111111110000000000
0011111111111000000000000000000000000000000011111111110000000000
0011111111111000000000000000000000000000000011111111110000000000
0011111111111000000000000000000000000000000011111111110000000000
0011111111111000000000000000000000000000000011111111110000000000
0111111111111000000000000000000000000000000011111111110000000000
0111111111111000000000000000000000000000000011111111110000000000
0111111111111000000000000000000000000000000011111111110000000000
0111111111111000000000000000000000000000000011111111110000000000
0111111111111000000000000000000000000000000011111111110000000000
0111111111111000000000000000000000000000000011111111110000000000
0111111111111000000000000000000000000000000011111111110000000000
0111111111111000000000000000000000000000000011111111110000000000
0111111111111000000000000000000000000000000011111111110000000000
0111111111111100000000000000000000000000000011111111110000000000
0111111111111100000000000000000000000000000011111111110000000000
0111111111111100000000000000000000000000000011111111110000000000
0011111111111100000000000000000000000000000011111111110000000000
0011111111111110000000000000000000000000000011111111110000000000
0011111111111110000000000000000000000000000011111111110000000000
0011111111111111000000000000000000000000000011111111110000000000
0001111111111111000000000000000000000000000011111111110000000000
0001111111111111100000000000000000000000000011111111110000000000
0000111111111111100000000000000000000000000011111111110000000000
0000111111111111110000000000000000000000000011111111110000000000
0000011111111111111000000000000000000000000011111111110000000000
0000011111111111111100000000000000000000000011111111110000000000
0000001111111111111110000000000000000000000011111111110000000000
0000000111111111111111000000000000000000000011111111110000000000
0000000111111111111111110000000000000000000011111111110000000000
0000000011111111111111111000000000000000000011111111110000000000
0000000001111111111111111111000000000000001111111111110000000000
0000000000111111111111111111111100000011111111111111110000000000
0000000000001111111111111111111111111111111111111111110000000000
0000000000000111111111111111111111111111111111111111110000000000
0000000000000001111111111111111111111111100011111111110000000000
0000000000000000011111111111111111111100000011111111110000000000
0000000000000000000111111111111111100000000011111111110000000000
0000000000000000000000011111111100000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111110000000000
0000000000000000000000000000000000000000000011111111111000000000
0000000000000000000000000000000000000000000011111111111000000000
0000000000000000000000000000000000000000000011111111111000000000
0000000000000000000000000000000000000000000111111111111000000000
0000000000000000000000000000000000000000000111111111111000000000
0000000000000000000000000000000000000000011111111111111110000000
0000000000000000000000000000000000001111111111111111111111111000
0000000000000000000000000000000011111111111111111111111111111111
0000000000000000000000000000000011111111111111111111111111111111
0000000000000000000000000000000011111111111111111111111111111111
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
6144 bits
$ java RunLength - < q64x96.bin > q64x96rle.bin
$ java BinaryDump 64 < q64x96rle.bin
1001111100001011001100000001010000101001001000000001111000100010
0001110000100100000110100010011000011000000010100000110100010001
0001011100001001000100100000111000010110000010000001010100001101
0001010000001001000110000000101100010011000010010001100100001011
0001001000001001000110100000101100010010000010000001101100001010
0001001000001001000110110000101000010001000010010001110000001010
0001000000001001000111010000101000010000000010010001110100001010
0000111100001010000111010000101000001110000010100001111000001010
0000111000001010000111100000101000001101000010110001111000001010
0000110100001010000111110000101000001101000010100001111100001010
0000110000001011000111110000101000001100000010110001111100001010
0000110000001011000111110000101000001100000010110001111100001010
0000101100001100000111110000101000001011000011000001111100001010
0000101100001100000111110000101000001011000011000001111100001010
0000101100001100000111110000101000001011000011000001111100001010
0000101100001100000111110000101000001011000011000001111100001010
0000101100001100000111110000101000001011000011010001111000001010
0000101100001101000111100000101000001011000011010001111000001010
0000110000001100000111100000101000001100000011010001110100001010
0000110000001101000111010000101000001100000011100001110000001010
0000110100001101000111000000101000001101000011100001101100001010
0000111000001101000110110000101000001110000011100001101000001010
0000111100001110000110010000101000001111000011110001100000001010
0001000000001111000101110000101000010001000011110001011000001010
0001000100010001000101000000101000010010000100010001001100001010
0001001100010011000011100000110000010100000101100000011000010000
0001011000101010000101110010100100011001000110100000001100001010
0001101100010101000001100000101000011101000100000000100100001010
0010000100001001000011000000101000110110000010100011011000001010
0011011000001010001101100000101000110110000010100011011000001010
0011011000001010001101100000101000110110000010100011011000001010
0011011000001010001101100000101000110110000010100011011000001010
0011011000001010001101100000101000110110000010100011011000001010
0011011000001011001101010000101100110101000010110011010000001100
0011010000001100001100100001000000101011000110010010001100100000
00100000001000000010000000100000111111110000000001000001
2296 bits
```

The compression ratio for q64x96.bin = **6144/2296 = 2.676**

As you can see when we doubled the dimensions we our compression ratio doubled aswell.
This is because when we double the width the number of runs doesn't change.
So the per row compression shouldn't change.
The number of bits quadrupled, but the number of compressed bits only doubled, so the compression ratio doubles.

